(()=>{var a={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return a.d(e,{a:e}),e},d:(t,e)=>{for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},o:(a,t)=>Object.prototype.hasOwnProperty.call(a,t)};(()=>{"use strict";const t=flarum.reg.get("core","common/extend"),e=flarum.reg.get("core","admin/app");var s=a.n(e);const l=flarum.reg.get("core","admin/components/BasicsPage");var r=a.n(l);const o=flarum.reg.get("core","admin/components/PermissionGrid");var i=a.n(o);const n=flarum.reg.get("core","admin/components/ExtensionPage");var d=a.n(n);const u=flarum.reg.get("core","admin/utils/saveSettings");var g=a.n(u);const c=flarum.reg.get("core","common/components/Alert");var _=a.n(c);const b=flarum.reg.get("core","common/components/Button");var f=a.n(b);const h=flarum.reg.get("core","common/components/FieldSet");var v=a.n(h);const p=flarum.reg.get("core","common/components/Switch");var k=a.n(p);const z=flarum.reg.get("core","common/components/UploadImageButton");var y=a.n(z);const x=flarum.reg.get("core","common/components/FormModal");var w=a.n(x);class C extends(w()){oninit(a){super.oninit(a),this.blogCategoriesOriginal=s().data.settings.blog_tags?s().data.settings.blog_tags.split("|"):[],this.blogCategories=s().data.settings.blog_tags?s().data.settings.blog_tags.split("|"):[],this.hasChanges=!1}title(){return s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.title")}className(){return"Modal modal-dialog FlarumBlog-TagsModal"}content(){return m("div",null,m("div",{className:"Modal-body"},m("p",null,s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.description")," ",m("a",{href:s().forum.attribute("baseUrl")+"/blog",target:"_blank"},s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.visit_blog"))),m("table",{className:"FlarumBlog-TagsTable"},m("thead",null,m("tr",null,m("th",{width:"35"}),m("th",null,s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.tag_name")),m("th",{width:"50"}))),m("tbody",null,0===s().store.all("tags").length&&m("tr",null,m("td",{colSpan:"3"},s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.no_tags"))),s().store.all("tags").map(a=>{if(a.parent())return;const t=()=>{const t=this.blogCategories.indexOf(a.id());this.hasChanges=!0,t>=0?this.blogCategories.splice(t,1):this.blogCategories.push(a.id())};return m("tr",null,m("td",null,m("i",{className:a.icon()})),m("td",{onclick:t},a.name()),m("td",null,m(k(),{state:this.blogCategories.indexOf(a.id())>=0,onchange:t})))})))),m("div",{style:"padding: 25px 30px; text-align: center;"},m(f(),{type:"submit",className:"Button Button--primary",loading:this.loading,disabled:this.loading},this.hasChanges?s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.save_changes"):s().translator.trans("vadkuz-flarum2-blog.admin.select_categories_modal.close"))))}onsubmit(a){if(a.preventDefault(),!this.hasChanges)return void this.hide();this.loading=!0;let t=[];this.blogCategories.map(a=>{s().store.getById("tags",a)&&t.push(a)}),g()({blog_tags:t.join("|")}).then(()=>{s().alerts.show(_(),{type:"success"},s().translator.trans("core.admin.settings.saved_message")),this.hide()}).catch(()=>{s().alerts.show(_(),{type:"error"},s().translator.trans("core.lib.error.generic_message"))}).then(()=>{this.loaded()})}}flarum.reg.add("vadkuz-flarum2-blog","admin/components/Modals/SelectCategoriesModal",C);class N extends(d()){oninit(a){var t,e,l,r,o,i,n,d,m,u;super.oninit(a),this.hasChanges=!1,this.isSaving=!1,this.redirectsEnabled=null!=(t=s().data.settings.blog_redirects_enabled)?t:"both",this.hideTagsInList=null==(e=s().data.settings.blog_hide_tags)||e,this.allowComments=null==(l=s().data.settings.blog_allow_comments)||l,this.hideOnDiscussionList=null!=(r=s().data.settings.blog_filter_discussion_list)&&r,this.requiresReviewOnPost=null!=(o=s().data.settings.blog_requires_review)&&o,this.addCategoryHierarchy=null==(i=s().data.settings.blog_category_hierarchy)||i,this.addSidebarNav=null==(n=s().data.settings.blog_add_sidebar_nav)||n,this.featuredCount=null!=(d=s().data.settings.blog_featured_count)?d:3,this.blogAddHero=null==(m=s().data.settings.blog_add_hero)||m;const g=null!=(u=s().data.settings.blog_default_image_path)?u:null;s().forum.data.attributes.blog_default_imageUrl=g?"".concat(s().forum.attribute("baseUrl"),"/assets/").concat(g):null}content(){const a=s().data.settings.blog_tags?s().data.settings.blog_tags.split("|").length:0;return m("div",{className:"BasicsPage FlarumBlog"},m("div",{className:"container"},m("div",{className:"FlarumBlog-SelectCategories"},0===a?s().translator.trans("vadkuz-flarum2-blog.admin.settings.no_categories_selected"):s().translator.trans("vadkuz-flarum2-blog.admin.settings.selected_category_count",{count:a}),m(f(),{className:"Button",onclick:()=>s().modal.show(C)},s().translator.trans("vadkuz-flarum2-blog.admin.settings.select_categories_button"))),v().component({label:s().translator.trans("vadkuz-flarum2-blog.admin.settings.blog_heading")},[k().component({state:1==this.allowComments,onchange:a=>{this.allowComments=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.allow_comments_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.allow_comments_text"))]),k().component({state:1==this.requiresReviewOnPost,onchange:a=>{this.requiresReviewOnPost=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.require_review_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.require_review_text"))]),k().component({state:1==this.hideOnDiscussionList,onchange:a=>{this.hideOnDiscussionList=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.hide_on_discussion_list_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.hide_on_discussion_list_text"))]),k().component({state:1==this.addSidebarNav,onchange:a=>{this.addSidebarNav=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.add_sidebar_nav_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.add_sidebar_nav_text"))]),k().component({state:1==this.blogAddHero,onchange:a=>{this.blogAddHero=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.add_hero_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.add_hero_text"))]),m("div",{className:"Form-group"},m("label",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.featured_count_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.featured_count_text")),m("input",{class:"FormControl",value:this.featuredCount,oninput:a=>{this.featuredCount=a.target.value,this.hasChanges=!0},placeholder:"3",type:"number"}))]),v().component({label:s().translator.trans("vadkuz-flarum2-blog.admin.settings.categories_heading")},[k().component({state:1==this.hideTagsInList,onchange:a=>{this.hideTagsInList=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.hide_tags_in_taglist_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.hide_tags_in_taglist_text"))]),k().component({state:1==this.addCategoryHierarchy,onchange:a=>{this.addCategoryHierarchy=a,this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.show_tag_hierarchy_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.show_tag_hierarchy_text"))])]),v().component({label:s().translator.trans("vadkuz-flarum2-blog.admin.settings.redirects_heading")},[k().component({state:"both"===this.redirectsEnabled||"discussions_only"===this.redirectsEnabled,onchange:a=>{a?"tags_only"===this.redirectsEnabled?this.redirectsEnabled="both":"none"===this.redirectsEnabled&&(this.redirectsEnabled="discussions_only"):"discussions_only"===this.redirectsEnabled?this.redirectsEnabled="none":this.redirectsEnabled="tags_only",this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.redirect_articles_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.redirect_articles_text"))]),k().component({state:"both"===this.redirectsEnabled||"tags_only"===this.redirectsEnabled,onchange:a=>{a?"discussions_only"===this.redirectsEnabled?this.redirectsEnabled="both":"none"===this.redirectsEnabled&&(this.redirectsEnabled="tags_only"):"tags_only"===this.redirectsEnabled?this.redirectsEnabled="none":this.redirectsEnabled="discussions_only",this.hasChanges=!0}},[m("b",null,s().translator.trans("vadkuz-flarum2-blog.admin.settings.redirect_tags_label")),m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.redirect_tags_text"))])]),v().component({label:s().translator.trans("vadkuz-flarum2-blog.admin.settings.default_article_image_label")},[m("div",{className:"helpText"},s().translator.trans("vadkuz-flarum2-blog.admin.settings.default_article_image_text")),y().component({name:"blog_default_image",routePath:"blog_default_image",value:()=>{var a;return null!=(a=s().data.settings.blog_default_image_path)?a:null},url:()=>{var a;return null!=(a=s().forum.attribute("blog_default_imageUrl"))?a:null}})]),m(f(),{loading:this.isSaving,className:"Button Button--primary",onclick:()=>this.save(),disabled:!this.hasChanges},s().translator.trans("core.admin.settings.submit_button"))))}save(){this.isSaving=!0,g()({blog_add_sidebar_nav:this.addSidebarNav,blog_redirects_enabled:this.redirectsEnabled,blog_hide_tags:this.hideTagsInList,blog_requires_review:this.requiresReviewOnPost,blog_allow_comments:this.allowComments,blog_category_hierarchy:this.addCategoryHierarchy,blog_filter_discussion_list:this.hideOnDiscussionList,blog_featured_count:this.featuredCount,blog_add_hero:this.blogAddHero}).then(()=>{this.hasChanges=!1,s().alerts.show(_(),{type:"success"},s().translator.trans("core.admin.settings.saved_message"))}).catch(()=>{}).then(()=>{this.isSaving=!1,m.redraw()})}}flarum.reg.add("vadkuz-flarum2-blog","admin/pages/BlogSettings",N);const E={"vadkuz-flarum2-blog.admin.blog":"Блог","vadkuz-flarum2-blog.admin.select_categories_modal.title":"Выбор категорий блога","vadkuz-flarum2-blog.admin.select_categories_modal.description":"Выберите один или несколько тегов, которые считаются категориями блога.","vadkuz-flarum2-blog.admin.select_categories_modal.visit_blog":"Перейти в блог.","vadkuz-flarum2-blog.admin.select_categories_modal.tag_name":"Название тега","vadkuz-flarum2-blog.admin.select_categories_modal.no_tags":"У вас пока нет тегов.","vadkuz-flarum2-blog.admin.select_categories_modal.save_changes":"Сохранить изменения","vadkuz-flarum2-blog.admin.select_categories_modal.close":"Закрыть","vadkuz-flarum2-blog.admin.permissions.approve_posts":"Может одобрять статьи блога","vadkuz-flarum2-blog.admin.permissions.auto_approve_posts":"Публиковать статьи без одобрения","vadkuz-flarum2-blog.admin.permissions.write_articles":"Писать и редактировать статьи блога","vadkuz-flarum2-blog.admin.settings.add_hero_label":"Показывать приветственный баннер","vadkuz-flarum2-blog.admin.settings.add_hero_text":"Показывать приветственный баннер на страницах блога, пока пользователь его не закрыл.","vadkuz-flarum2-blog.admin.settings.add_sidebar_nav_label":"Добавить в боковую навигацию","vadkuz-flarum2-blog.admin.settings.add_sidebar_nav_text":"Добавить ссылку на блог в боковое меню навигации.","vadkuz-flarum2-blog.admin.settings.allow_comments_label":"Разрешить комментарии","vadkuz-flarum2-blog.admin.settings.allow_comments_text":"По умолчанию разрешены комментарии к записям блога. При отключении их можно включать отдельно для каждой записи. Примечание: изменение этой настройки не влияет на уже существующие записи блога.","vadkuz-flarum2-blog.admin.settings.blog_heading":"Блог","vadkuz-flarum2-blog.admin.settings.categories_heading":"Категории","vadkuz-flarum2-blog.admin.settings.default_article_image_label":"Изображение статьи по умолчанию","vadkuz-flarum2-blog.admin.settings.default_article_image_text":"Выберите изображение по умолчанию, которое будет показываться, если у статьи нет собственного изображения.","vadkuz-flarum2-blog.admin.settings.featured_count_label":"Макс. число избранных постов","vadkuz-flarum2-blog.admin.settings.featured_count_text":"Сколько постов должно отображаться в большой сетке вверху страницы блога?","vadkuz-flarum2-blog.admin.settings.hide_on_discussion_list_label":"Не показывать в списке обсуждений","vadkuz-flarum2-blog.admin.settings.hide_on_discussion_list_text":"Скрывать записи блога из списка обсуждений.","vadkuz-flarum2-blog.admin.settings.hide_tags_in_taglist_label":"Скрыть теги в списке тегов","vadkuz-flarum2-blog.admin.settings.hide_tags_in_taglist_text":"Если включено, это расширение скроет теги блога с главной страницы.","vadkuz-flarum2-blog.admin.settings.no_categories_selected":"Категории не выбраны","vadkuz-flarum2-blog.admin.settings.redirect_articles_label":"Переадресовывать статьи блога","vadkuz-flarum2-blog.admin.settings.redirect_articles_text":"Если включено, расширение будет перенаправлять исходные URL обсуждений на URL статьи в блоге.","vadkuz-flarum2-blog.admin.settings.redirect_tags_label":"Переадресовывать теги блога","vadkuz-flarum2-blog.admin.settings.redirect_tags_text":"Если включено, расширение перенаправляет URL тегов блога на URL категории блога.","vadkuz-flarum2-blog.admin.settings.redirects_heading":"Переадресации","vadkuz-flarum2-blog.admin.settings.require_review_label":"Записи блога требуют модерации","vadkuz-flarum2-blog.admin.settings.require_review_text":"При публикации статья не будет видна сразу и должна быть одобрена модератором.","vadkuz-flarum2-blog.admin.settings.select_categories_button":"Выбрать категории блога","vadkuz-flarum2-blog.admin.settings.selected_category_count":"{count, plural, one {Выбрана # категория} few {Выбрано # категории} many {Выбрано # категорий} other {Выбрано # категории}}","vadkuz-flarum2-blog.admin.settings.show_tag_hierarchy_label":"Показывать иерархию тегов","vadkuz-flarum2-blog.admin.settings.show_tag_hierarchy_text":"Добавляет отступы дочерним категориям и делает список категорий иерархическим.","vadkuz-flarum2-blog.forum.article.slug":"Слаг","vadkuz-flarum2-blog.forum.article.summary":"Краткое описание","vadkuz-flarum2-blog.forum.article.title":"Заголовок","vadkuz-flarum2-blog.forum.article_settings.fields.highlight.helper_text":"Показывать эту статью с большим изображением на странице обзора блога.","vadkuz-flarum2-blog.forum.article_settings.fields.highlight.title":"Выделенная статья","vadkuz-flarum2-blog.forum.article_settings.fields.image.helper_text":"Лучшее разрешение для соцсетей: 1200x630","vadkuz-flarum2-blog.forum.article_settings.fields.image.title":"Изображение статьи","vadkuz-flarum2-blog.forum.article_settings.fields.summary.helper_text":"Это описание отображается на странице обзора блога и используется для SEO.","vadkuz-flarum2-blog.forum.article_settings.fields.summary.placeholder":"Введите краткое описание","vadkuz-flarum2-blog.forum.article_settings.fields.summary.title":"Краткое описание статьи","vadkuz-flarum2-blog.forum.article_settings.title":"Настройки статьи блога","vadkuz-flarum2-blog.forum.blog":"Блог","vadkuz-flarum2-blog.forum.categories":"Категории","vadkuz-flarum2-blog.forum.category_empty":"В этой категории нет записей блога.","vadkuz-flarum2-blog.forum.comment_section.comments":"Комментарии","vadkuz-flarum2-blog.forum.comment_section.locked":"Раздел комментариев отключен для этой статьи","vadkuz-flarum2-blog.forum.compose.write_article":"Написать статью","vadkuz-flarum2-blog.forum.composer.comment_section":"Раздел комментариев недоступен при написании статьи.","vadkuz-flarum2-blog.forum.composer.edit_categories":"Изменить категории","vadkuz-flarum2-blog.forum.composer.enter_message_here":"Введите сообщение","vadkuz-flarum2-blog.forum.composer.no_blog_tags_selected":"Среди выбранных тегов нет блог-тега. Пожалуйста, выберите хотя бы один.","vadkuz-flarum2-blog.forum.composer.no_title":"Без заголовка","vadkuz-flarum2-blog.forum.composer.nothing_to_preview":"Нечего показывать в предпросмотре","vadkuz-flarum2-blog.forum.composer.post_article":"Опубликовать статью","vadkuz-flarum2-blog.forum.composer.post_without_blog_info":"Вы уверены, что хотите опубликовать эту статью? Вы еще не указали краткое описание или изображение.","vadkuz-flarum2-blog.forum.composer.select_category":"Выбрать категорию","vadkuz-flarum2-blog.forum.composer.update_settings":"Обновить настройки блога","vadkuz-flarum2-blog.forum.composer.view":"Предпросмотр","vadkuz-flarum2-blog.forum.composer.write":"Написать","vadkuz-flarum2-blog.forum.forum_nav":"Навигация форума","vadkuz-flarum2-blog.forum.hidden":"Скрыто","vadkuz-flarum2-blog.forum.no_more_posts":"Больше нет записей в блоге.","vadkuz-flarum2-blog.forum.read_more":"Читать далее","vadkuz-flarum2-blog.forum.recent_posts":"Последние записи блога","vadkuz-flarum2-blog.forum.return_to_overview":"Вернуться к обзору блога","vadkuz-flarum2-blog.forum.review_article.approve_article":"Одобрить статью","vadkuz-flarum2-blog.forum.review_article.approve_article_approved":"Статья одобрена и опубликована","vadkuz-flarum2-blog.forum.review_article.pending_review":"Эта статья ожидает проверки и еще не опубликована","vadkuz-flarum2-blog.forum.review_article.pending_review_title":"На модерации","vadkuz-flarum2-blog.forum.tools.approve_article":"Одобрить статью","vadkuz-flarum2-blog.forum.tools.article_settings":"Настройки статьи","vadkuz-flarum2-blog.forum.tools.delete_forever":"Удалить навсегда","vadkuz-flarum2-blog.forum.tools.disable_comments":"Отключить комментарии","vadkuz-flarum2-blog.forum.tools.edit_article":"Редактировать статью","vadkuz-flarum2-blog.forum.tools.enable_comments":"Включить комментарии","vadkuz-flarum2-blog.forum.tools.hide_article":"Скрыть статью","vadkuz-flarum2-blog.forum.tools.manage":"Управление","vadkuz-flarum2-blog.forum.tools.recover_article":"Восстановить статью","vadkuz-flarum2-blog.forum.tools.rename_article":"Переименовать статью","vadkuz-flarum2-blog.forum.tools.update_category":"Обновить категории","vadkuz-flarum2-blog.forum.utils.redirect.link":"<a>Нажмите здесь</a>, если перенаправление не произошло","vadkuz-flarum2-blog.forum.utils.redirect.title":"Перенаправляем вас на статью блога...","vadkuz-flarum2-blog.forum.placeholders.ghost_title":"Черновой заголовок","vadkuz-flarum2-blog.forum.placeholders.ghost_category":"Категория","vadkuz-flarum2-blog.forum.validation.missing_id":"Отсутствует ID"};function P(a){var t,e,s;const l=String((null==a||null==(t=a.data)?void 0:t.locale)||(null==a||null==(e=a.translator)||null==(s=e.getLocale)?void 0:s.call(e))||"").toLowerCase();("ru"===l||l.startsWith("ru-"))&&a.translator.addTranslations(E)}flarum.reg.add("vadkuz-flarum2-blog","common/translations/ru",P),s().initializers.add("vadkuz-flarum2-blog",()=>{P(s()),s().registry.for("vadkuz-flarum2-blog").registerPage(N),s().registry.for("vadkuz-flarum2-blog").registerPermission({icon:"fas fa-pencil-alt",label:s().translator.trans("vadkuz-flarum2-blog.admin.permissions.write_articles"),permission:"blog.writeArticles"},"blog",90).registerPermission({icon:"far fa-star",label:s().translator.trans("vadkuz-flarum2-blog.admin.permissions.auto_approve_posts"),permission:"blog.autoApprovePosts"},"blog",90).registerPermission({icon:"far fa-thumbs-up",label:s().translator.trans("vadkuz-flarum2-blog.admin.permissions.approve_posts"),permission:"blog.canApprovePosts"},"blog",90),(0,t.extend)(i().prototype,"permissionItems",function(a){var t,e,l,r;const o=null==(t=this.attrs)?void 0:t.extensionId,i=o?null!=(e=null==(l=s().registry.getExtensionPermissions(o,"blog"))||null==(r=l.toArray)?void 0:r.call(l))?e:[]:s().registry.getAllPermissions("blog").toArray();a.add("blog",{label:s().translator.trans("vadkuz-flarum2-blog.admin.blog"),children:i},80)}),(0,t.extend)(r().prototype,"homePageItems",a=>{a.add("blog",{path:"/blog",label:s().translator.trans("vadkuz-flarum2-blog.admin.blog")})})})})(),module.exports={}})();
//# sourceMappingURL=admin.js.map